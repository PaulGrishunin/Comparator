{"ast":null,"code":"import _extends from 'babel-runtime/helpers/extends';\nimport _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\n/**\n * Created by jljsj on 16/1/13.\n */\n\nimport React, { createElement } from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\nimport easingTypes from 'tween-functions';\nimport requestAnimationFrame from 'raf';\nimport EventListener from './EventDispatcher';\nimport { noop, transformArguments, currentScrollTop, windowHeight } from './util';\nvar scrollLinkLists = [];\n\nvar ScrollLink = function (_React$Component) {\n  _inherits(ScrollLink, _React$Component);\n\n  function ScrollLink(props) {\n    _classCallCheck(this, ScrollLink);\n\n    var _this = _possibleConstructorReturn(this, (ScrollLink.__proto__ || Object.getPrototypeOf(ScrollLink)).call(this, props));\n\n    _this.onClick = function (e) {\n      e.preventDefault();\n      EventListener.removeAllType('scroll.scrollAnchorEvent');\n      _this.elementDom = document.getElementById(_this.props.to);\n      ;\n\n      if (_this.rafID !== -1 || !_this.elementDom) {\n        return;\n      }\n\n      _this.scrollTop = _this.target ? _this.target.scrollTop : currentScrollTop();\n      _this.initTime = Date.now();\n      _this.rafID = requestAnimationFrame(_this.raf);\n      scrollLinkLists.forEach(function (item) {\n        if (item !== _this) {\n          item.remActive();\n        }\n      });\n\n      _this.addActive();\n    };\n\n    _this.getToTop = function () {\n      var elementRect = _this.elementDom && _this.elementDom.getBoundingClientRect();\n\n      _this.clientHeight = _this.target ? _this.target.clientHeight : windowHeight();\n      var targetTop = _this.target ? _this.target.getBoundingClientRect().top : 0;\n      var toTop = Math.round(elementRect.top + currentScrollTop()) - _this.props.offsetTop - targetTop;\n      var t = transformArguments(_this.props.showHeightActive)[0];\n      var toShow = t.match('%') ? _this.clientHeight * parseFloat(t) / 100 : t;\n      return _this.props.toShowHeight ? toTop - toShow + 0.5 : toTop;\n    };\n\n    _this.cancelRequestAnimationFrame = function () {\n      requestAnimationFrame.cancel(_this.rafID);\n      _this.rafID = -1;\n    };\n\n    _this.addActive = function () {\n      if (!_this.state.active) {\n        var obj = {\n          target: _this.dom,\n          to: _this.props.to\n        };\n\n        _this.props.onFocus(obj);\n\n        _this.setState({\n          active: true\n        }, function () {\n          if (_this.props.toHash) {\n            var link = '#' + _this.props.to;\n            history.pushState(null, window.title, link); // eslint-disable-line\n          }\n        });\n      }\n    };\n\n    _this.raf = function () {\n      if (_this.rafID === -1) {\n        return;\n      }\n\n      var duration = _this.props.duration;\n      var now = Date.now();\n      var progressTime = now - _this.initTime > duration ? duration : now - _this.initTime; // 动画时也会改变高度，动态获取\n\n      var easeValue = easingTypes[_this.props.ease](progressTime, _this.scrollTop, _this.getToTop(), duration);\n\n      if (_this.target) {\n        _this.target.scrollTop = easeValue;\n      } else {\n        window.scrollTo(window.scrollX, easeValue);\n      }\n\n      if (progressTime === duration) {\n        _this.elementDom = null;\n\n        _this.cancelRequestAnimationFrame();\n\n        EventListener.reAllType('scroll.scrollAnchorEvent');\n      } else {\n        _this.rafID = requestAnimationFrame(_this.raf);\n      }\n    };\n\n    _this.remActive = function () {\n      if (_this.state.active) {\n        var obj = {\n          target: _this.dom,\n          to: _this.props.to\n        };\n\n        _this.props.onBlur(obj);\n\n        _this.setState({\n          active: false\n        });\n      }\n    };\n\n    _this.scrollEventListener = function () {\n      var elementDom = document.getElementById(_this.props.to);\n\n      if (!elementDom) {\n        return;\n      } // 滚动时会改变高度, 动态获取高度\n\n\n      var clientHeight = _this.target ? _this.target.clientHeight : windowHeight();\n      var elementRect = elementDom.getBoundingClientRect();\n      var elementClientHeight = elementDom.clientHeight;\n      var targetTop = _this.target ? _this.target.getBoundingClientRect().top : 0;\n      var top = Math.round(-elementRect.top + targetTop);\n      var showHeightActive = transformArguments(_this.props.showHeightActive);\n      var startShowHeight = showHeightActive[0].toString().indexOf('%') >= 0 ? parseFloat(showHeightActive[0]) / 100 * clientHeight : parseFloat(showHeightActive[0]);\n      var endShowHeight = showHeightActive[1].toString().indexOf('%') >= 0 ? parseFloat(showHeightActive[1]) / 100 * clientHeight : parseFloat(showHeightActive[1]);\n\n      if (top >= Math.round(-startShowHeight) && top < Math.round(elementClientHeight - endShowHeight)) {\n        _this.addActive();\n      } else {\n        _this.remActive();\n      }\n    };\n\n    _this.rafID = -1;\n    _this.state = {\n      active: false\n    };\n    return _this;\n  }\n\n  _createClass(ScrollLink, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.dom = ReactDOM.findDOMNode(this);\n      this.target = this.props.targetId && document.getElementById(this.props.targetId);\n      scrollLinkLists.push(this);\n      var date = Date.now();\n      var length = EventListener._listeners.scroll ? EventListener._listeners.scroll.length : 0;\n      this.eventType = 'scroll.scrollAnchorEvent' + date + length;\n      EventListener.addEventListener(this.eventType, this.scrollEventListener, this.target); // 第一次进入；等全部渲染完成后执行;\n\n      setTimeout(function () {\n        _this2.scrollEventListener();\n      });\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      var _this3 = this;\n\n      scrollLinkLists = scrollLinkLists.filter(function (item) {\n        return item !== _this3;\n      });\n      EventListener.removeEventListener(this.eventType, this.scrollEventListener, this.target);\n      this.cancelRequestAnimationFrame();\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this4 = this;\n\n      var _props = this.props,\n          component = _props.component,\n          onClick = _props.onClick,\n          duration = _props.duration,\n          tagActive = _props.active,\n          showHeightActive = _props.showHeightActive,\n          ease = _props.ease,\n          toShowHeight = _props.toShowHeight,\n          offsetTop = _props.offsetTop,\n          targetId = _props.targetId,\n          to = _props.to,\n          toHash = _props.toHash,\n          componentProps = _props.componentProps,\n          props = _objectWithoutProperties(_props, ['component', 'onClick', 'duration', 'active', 'showHeightActive', 'ease', 'toShowHeight', 'offsetTop', 'targetId', 'to', 'toHash', 'componentProps']);\n\n      var active = this.state.active ? tagActive : '';\n\n      props.onClick = function (e) {\n        onClick(e);\n\n        _this4.onClick(e);\n      };\n\n      var reg = new RegExp(active, 'ig');\n      var className = props.className || '';\n      props.className = className.indexOf(active) === -1 ? (className + ' ' + active).trim() : className.replace(reg, '').trim();\n      return createElement(this.props.component, _extends({}, props, componentProps));\n    }\n  }]);\n\n  return ScrollLink;\n}(React.Component);\n\nScrollLink.propTypes = {\n  component: PropTypes.any,\n  children: PropTypes.any,\n  className: PropTypes.string,\n  style: PropTypes.any,\n  offsetTop: PropTypes.number,\n  duration: PropTypes.number,\n  active: PropTypes.string,\n  to: PropTypes.string,\n  targetId: PropTypes.string,\n  showHeightActive: PropTypes.any,\n  toShowHeight: PropTypes.bool,\n  ease: PropTypes.string,\n  onClick: PropTypes.func,\n  onFocus: PropTypes.func,\n  onBlur: PropTypes.func,\n  toHash: PropTypes.bool,\n  componentProps: PropTypes.object\n};\nScrollLink.defaultProps = {\n  component: 'div',\n  offsetTop: 0,\n  duration: 450,\n  active: 'active',\n  showHeightActive: '50%',\n  ease: 'easeInOutQuad',\n  toHash: false,\n  onClick: noop,\n  onFocus: noop,\n  onBlur: noop,\n  componentProps: {}\n};\nScrollLink.isScrollLink = true;\nexport default ScrollLink;","map":{"version":3,"sources":["/home/paul/Comparator/frontend/node_modules/rc-scroll-anim/es/ScrollLink.js"],"names":["_extends","_objectWithoutProperties","_classCallCheck","_createClass","_possibleConstructorReturn","_inherits","React","createElement","ReactDOM","PropTypes","easingTypes","requestAnimationFrame","EventListener","noop","transformArguments","currentScrollTop","windowHeight","scrollLinkLists","ScrollLink","_React$Component","props","_this","__proto__","Object","getPrototypeOf","call","onClick","e","preventDefault","removeAllType","elementDom","document","getElementById","to","rafID","scrollTop","target","initTime","Date","now","raf","forEach","item","remActive","addActive","getToTop","elementRect","getBoundingClientRect","clientHeight","targetTop","top","toTop","Math","round","offsetTop","t","showHeightActive","toShow","match","parseFloat","toShowHeight","cancelRequestAnimationFrame","cancel","state","active","obj","dom","onFocus","setState","toHash","link","history","pushState","window","title","duration","progressTime","easeValue","ease","scrollTo","scrollX","reAllType","onBlur","scrollEventListener","elementClientHeight","startShowHeight","toString","indexOf","endShowHeight","key","value","componentDidMount","_this2","findDOMNode","targetId","push","date","length","_listeners","scroll","eventType","addEventListener","setTimeout","componentWillUnmount","_this3","filter","removeEventListener","render","_this4","_props","component","tagActive","componentProps","reg","RegExp","className","trim","replace","Component","propTypes","any","children","string","style","number","bool","func","object","defaultProps","isScrollLink"],"mappings":"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","sourcesContent":["import _extends from 'babel-runtime/helpers/extends';\nimport _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\n/**\n * Created by jljsj on 16/1/13.\n */\nimport React, { createElement } from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\nimport easingTypes from 'tween-functions';\nimport requestAnimationFrame from 'raf';\nimport EventListener from './EventDispatcher';\nimport { noop, transformArguments, currentScrollTop, windowHeight } from './util';\n\nvar scrollLinkLists = [];\n\nvar ScrollLink = function (_React$Component) {\n  _inherits(ScrollLink, _React$Component);\n\n  function ScrollLink(props) {\n    _classCallCheck(this, ScrollLink);\n\n    var _this = _possibleConstructorReturn(this, (ScrollLink.__proto__ || Object.getPrototypeOf(ScrollLink)).call(this, props));\n\n    _this.onClick = function (e) {\n      e.preventDefault();\n      EventListener.removeAllType('scroll.scrollAnchorEvent');\n      _this.elementDom = document.getElementById(_this.props.to);;\n      if (_this.rafID !== -1 || !_this.elementDom) {\n        return;\n      }\n      _this.scrollTop = _this.target ? _this.target.scrollTop : currentScrollTop();\n      _this.initTime = Date.now();\n      _this.rafID = requestAnimationFrame(_this.raf);\n      scrollLinkLists.forEach(function (item) {\n        if (item !== _this) {\n          item.remActive();\n        }\n      });\n      _this.addActive();\n    };\n\n    _this.getToTop = function () {\n      var elementRect = _this.elementDom && _this.elementDom.getBoundingClientRect();\n      _this.clientHeight = _this.target ? _this.target.clientHeight : windowHeight();\n      var targetTop = _this.target ? _this.target.getBoundingClientRect().top : 0;\n      var toTop = Math.round(elementRect.top + currentScrollTop()) - _this.props.offsetTop - targetTop;\n      var t = transformArguments(_this.props.showHeightActive)[0];\n      var toShow = t.match('%') ? _this.clientHeight * parseFloat(t) / 100 : t;\n      return _this.props.toShowHeight ? toTop - toShow + 0.5 : toTop;\n    };\n\n    _this.cancelRequestAnimationFrame = function () {\n      requestAnimationFrame.cancel(_this.rafID);\n      _this.rafID = -1;\n    };\n\n    _this.addActive = function () {\n      if (!_this.state.active) {\n        var obj = {\n          target: _this.dom,\n          to: _this.props.to\n        };\n        _this.props.onFocus(obj);\n        _this.setState({\n          active: true\n        }, function () {\n          if (_this.props.toHash) {\n            var link = '#' + _this.props.to;\n            history.pushState(null, window.title, link); // eslint-disable-line\n          }\n        });\n      }\n    };\n\n    _this.raf = function () {\n      if (_this.rafID === -1) {\n        return;\n      }\n      var duration = _this.props.duration;\n      var now = Date.now();\n      var progressTime = now - _this.initTime > duration ? duration : now - _this.initTime;\n      // 动画时也会改变高度，动态获取\n      var easeValue = easingTypes[_this.props.ease](progressTime, _this.scrollTop, _this.getToTop(), duration);\n      if (_this.target) {\n        _this.target.scrollTop = easeValue;\n      } else {\n        window.scrollTo(window.scrollX, easeValue);\n      }\n      if (progressTime === duration) {\n        _this.elementDom = null;\n        _this.cancelRequestAnimationFrame();\n        EventListener.reAllType('scroll.scrollAnchorEvent');\n      } else {\n        _this.rafID = requestAnimationFrame(_this.raf);\n      }\n    };\n\n    _this.remActive = function () {\n      if (_this.state.active) {\n        var obj = {\n          target: _this.dom,\n          to: _this.props.to\n        };\n        _this.props.onBlur(obj);\n        _this.setState({\n          active: false\n        });\n      }\n    };\n\n    _this.scrollEventListener = function () {\n      var elementDom = document.getElementById(_this.props.to);\n      if (!elementDom) {\n        return;\n      }\n      // 滚动时会改变高度, 动态获取高度\n      var clientHeight = _this.target ? _this.target.clientHeight : windowHeight();\n      var elementRect = elementDom.getBoundingClientRect();\n      var elementClientHeight = elementDom.clientHeight;\n      var targetTop = _this.target ? _this.target.getBoundingClientRect().top : 0;\n      var top = Math.round(-elementRect.top + targetTop);\n      var showHeightActive = transformArguments(_this.props.showHeightActive);\n      var startShowHeight = showHeightActive[0].toString().indexOf('%') >= 0 ? parseFloat(showHeightActive[0]) / 100 * clientHeight : parseFloat(showHeightActive[0]);\n      var endShowHeight = showHeightActive[1].toString().indexOf('%') >= 0 ? parseFloat(showHeightActive[1]) / 100 * clientHeight : parseFloat(showHeightActive[1]);\n      if (top >= Math.round(-startShowHeight) && top < Math.round(elementClientHeight - endShowHeight)) {\n        _this.addActive();\n      } else {\n        _this.remActive();\n      }\n    };\n\n    _this.rafID = -1;\n    _this.state = {\n      active: false\n    };\n    return _this;\n  }\n\n  _createClass(ScrollLink, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.dom = ReactDOM.findDOMNode(this);\n      this.target = this.props.targetId && document.getElementById(this.props.targetId);\n      scrollLinkLists.push(this);\n      var date = Date.now();\n      var length = EventListener._listeners.scroll ? EventListener._listeners.scroll.length : 0;\n      this.eventType = 'scroll.scrollAnchorEvent' + date + length;\n      EventListener.addEventListener(this.eventType, this.scrollEventListener, this.target);\n      // 第一次进入；等全部渲染完成后执行;\n      setTimeout(function () {\n        _this2.scrollEventListener();\n      });\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      var _this3 = this;\n\n      scrollLinkLists = scrollLinkLists.filter(function (item) {\n        return item !== _this3;\n      });\n      EventListener.removeEventListener(this.eventType, this.scrollEventListener, this.target);\n      this.cancelRequestAnimationFrame();\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this4 = this;\n\n      var _props = this.props,\n          component = _props.component,\n          onClick = _props.onClick,\n          duration = _props.duration,\n          tagActive = _props.active,\n          showHeightActive = _props.showHeightActive,\n          ease = _props.ease,\n          toShowHeight = _props.toShowHeight,\n          offsetTop = _props.offsetTop,\n          targetId = _props.targetId,\n          to = _props.to,\n          toHash = _props.toHash,\n          componentProps = _props.componentProps,\n          props = _objectWithoutProperties(_props, ['component', 'onClick', 'duration', 'active', 'showHeightActive', 'ease', 'toShowHeight', 'offsetTop', 'targetId', 'to', 'toHash', 'componentProps']);\n\n      var active = this.state.active ? tagActive : '';\n      props.onClick = function (e) {\n        onClick(e);\n        _this4.onClick(e);\n      };\n      var reg = new RegExp(active, 'ig');\n      var className = props.className || '';\n      props.className = className.indexOf(active) === -1 ? (className + ' ' + active).trim() : className.replace(reg, '').trim();\n      return createElement(this.props.component, _extends({}, props, componentProps));\n    }\n  }]);\n\n  return ScrollLink;\n}(React.Component);\n\nScrollLink.propTypes = {\n  component: PropTypes.any,\n  children: PropTypes.any,\n  className: PropTypes.string,\n  style: PropTypes.any,\n  offsetTop: PropTypes.number,\n  duration: PropTypes.number,\n  active: PropTypes.string,\n  to: PropTypes.string,\n  targetId: PropTypes.string,\n  showHeightActive: PropTypes.any,\n  toShowHeight: PropTypes.bool,\n  ease: PropTypes.string,\n  onClick: PropTypes.func,\n  onFocus: PropTypes.func,\n  onBlur: PropTypes.func,\n  toHash: PropTypes.bool,\n  componentProps: PropTypes.object\n};\nScrollLink.defaultProps = {\n  component: 'div',\n  offsetTop: 0,\n  duration: 450,\n  active: 'active',\n  showHeightActive: '50%',\n  ease: 'easeInOutQuad',\n  toHash: false,\n  onClick: noop,\n  onFocus: noop,\n  onBlur: noop,\n  componentProps: {}\n};\n\nScrollLink.isScrollLink = true;\n\nexport default ScrollLink;"]},"metadata":{},"sourceType":"module"}